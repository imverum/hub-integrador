{% extends 'base.html' %}
{% load custom_filter_tags %}
{% load static %}

{% block main %}

   </head>
   <body class="inner_page profile_page">
      <div class="full_container">
         <div class="inner_container">
               <!-- end topbar -->
               <!-- dashboard inner -->
               <div class="midde_cont">
                  <div class="container-fluid">

                     <!-- row -->
                     <div class="row column1">
                        <div class="col-md-2"></div>
                        <div class="col-md-8">
                           <div class="white_shd full margin_bottom_30">
                              <div class="full graph_head">
                                 <div class="heading1 margin_0">
                                    <h2>Perfil do usuario</h2>
                                 </div>
                                 <div>

                                     <button type="button" class="btn  btn-success dropdown-toggle  float-right" data-toggle="dropdown" aria-expanded="false">+ Ações</button>
                                    <div class="dropdown-menu" x-placement="top-start" style="position: absolute; transform: translate3d(0px, -2px, 0px); top: 0px; left: 0px; will-change: transform;">
                                                        {% if profile_perfil.role == 1 %}
                                                      <button type="button" class="dropdown-item" data-toggle="modal" data-target="#myModalUnidade">Adicionar Unidade</button>
                                                      <button type="button" class="dropdown-item" data-toggle="modal" data-target="#myModalProjeto">Adicionar Projeto</button>
                                                        {% endif %}

                                                        {% if profile_perfil.user.id == user.id %}
                                                      <a type="button" class="dropdown-item" href="{% url 'password_change' %}">Trocar Senha</a>
                                                        {% endif %}
                                 </div>
                              </div>
                              <div class="full price_table padding_infor_info">
                                 <div class="row">
                                    <!-- user profile section --> 
                                    <!-- profile image -->
                                    <div class="col-lg-12">
                                       <div class="full dis_flex center_text">

                                           {% if profile_perfil.user_photo %}
                                           <div class="profile_img"><img width="180" class="rounded-circle" src="{{ profile_perfil.user_photo.url }}" alt="Foto Perfil" /></div>
                                           {% else %}
                                          <div class="profile_img"><img width="180" class="rounded-circle" src="{% static 'images/layout_img/user_img.png' %}" alt="Foto Perfil" /></div>
                                          {% endif %}
                                           <div class="profile_contant">
                                             <div class="contact_inner">
                                                 <div class="row" style="display: inline-block">
                                                     <h3>{{profile.nome}}</h3>
                                                     {% if profile_perfil.user.id == user.id %}
                                                    <h1>   </h1>
                                                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal"><i class="fa fa-pencil"></i></button>
                                                    {% endif %}
                                                 </div>

                                                <p><strong>Registro: </strong>{{profile_perfil.role|tipo_registro}}</p>
                                                <ul class="list-unstyled">
                                                   <li><i class="fa fa-envelope-o"></i> : {{usuario.email}}</li>

                                                </ul>
                                             </div>
                                          </div>
                                       </div>
                                       <!-- profile contant section -->
                                       <div class="full inner_elements margin_top_30">
                                          <div class="tab_style2">
                                             <div class="tabbar">
                                                <nav>
                                                   <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                                      <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#recent_activity" role="tab" aria-selected="true">Unidades</a>
                                                      <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#profile_section" role="tab" aria-selected="false">Projetos</a>
                                                   </div>
                                                </nav>
                                                <div class="tab-content" id="nav-tabContent">
                                                   <div class="tab-pane fade show active" id="recent_activity" role="tabpanel" aria-labelledby="nav-home-tab">
                                                      <div class="table-responsive-sm">
                                    <table class="table">
                                       <thead>
                                          <tr>
                                             <th><center>Unidade </center></th>
                                              {% if profile_perfil.role == 1 %}
                                             <th><center>Deletar </center></th>
                                              {% endif %}
                                          </tr>
                                       </thead>
                                       <tbody>
                                       {% for unidade in unidades %}
                                          <tr>
                                             <td><center>{{unidade.unidade}}</center></td>
                                              {% if profile_perfil.role == 1 %}
                                             <td>

                                                 <center>
                                                        <a class="btn btn-danger" data-placement="right" href="{% url 'deletar_unidade' unidade.id %}">Deletar</a>
                                                 </center>

                                             </td>
                                              {% endif %}

                                          </tr>
                                       {% endfor %}
                                       </tbody>
                                    </table>
                                 </div>
                                                   </div>
                                                   <div class="tab-pane fade" id="project_worked" role="tabpanel" aria-labelledby="nav-profile-tab">


                                                   </div>
                                                   <div class="tab-pane fade" id="profile_section" role="tabpanel" aria-labelledby="nav-contact-tab">
                                                      <table class="table">
                                       <thead>
                                          <tr>
                                             <th><center>Projeto </center></th>
                                              {% if profile_perfil.role == 1 %}
                                             <th><center>Deletar </center></th>
                                              {% endif %}
                                          </tr>
                                       </thead>
                                       <tbody>
                                       {% for projeto in projetos %}
                                          <tr>
                                             <td><center>{{projeto.projeto}}</center></td>
                                              {% if profile_perfil.role == 1 %}
                                             <td>

                                                 <center>
                                                        <a class="btn btn-danger" data-placement="right" href="{% url 'deletar_projeto' projeto.id %}">Deletar</a>
                                                 </center>
                                             </td>
                                              {% endif %}

                                          </tr>
                                       {% endfor %}
                                       </tbody>
                                    </table>
                                                   </div>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                       <!-- end user profile section -->
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-md-2"></div>
                        </div>
                        <!-- end row -->
                     </div>
                     <!-- footer -->
                     <div class="container-fluid">
                        <div class="footer">

                           </p>
                        </div>
                     </div>
                  </div>
                  <!-- end dashboard inner -->
               </div>
            </div>
         </div>
      </div>

   </body>
<form name="form" id="form" class="form-horizontal" method="post"  action="{% url 'profile_edit' usuario.id %}" enctype="multipart/form-data">
{% csrf_token %}
    <!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content" >
      <div class="modal-header">
          <h3 class="modal-title">Editar</h3>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
          <div class="form-group">
              <div class="col-sm-8" >
                  <fieldset>
                      <div class="field">
                        {{ form_profile.as_p }}
                      </div>
                  </fieldset>
              </div>
          </div>

      </div>
      <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Salvar</button>
      </div>
    </div>

  </div>
</div>
</form>

<form name="form" id="formunidade" class="form-horizontal" method="post" action="{% url 'adicionar_unidade' usuario.id %}">
{% csrf_token %}
    <!-- Modal -->
<div id="myModalUnidade" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content" >
      <div class="modal-header">
          <h3 class="modal-title">Adicionar Unidade</h3>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
          <div class="form-group">
              <div class="col-sm-8" >
                  <fieldset>
                      <div class="field">
                        {{ form_unidade.as_p }}
                      </div>
                  </fieldset>
              </div>
          </div>

      </div>
      <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Salvar</button>
      </div>
    </div>

  </div>
</div>
</form>


<form name="form" id="formprojeto" class="form-horizontal" method="post" action="{% url 'adicionar_projeto' usuario.id %}">
{% csrf_token %}
    <!-- Modal -->
<div id="myModalProjeto" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content" >
      <div class="modal-header">
          <h3 class="modal-title">Adicionar Projeto</h3>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
          <div class="form-group">
              <div class="col-sm-8" >
                  <fieldset>
                      <div class="field">
                        {{ form_projeto_usuario.as_p }}
                      </div>
                  </fieldset>
              </div>
          </div>

      </div>
      <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Salvar</button>
      </div>
    </div>

  </div>
</div>
</form>
{% endblock %}